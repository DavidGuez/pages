<style>
ul.social_buttons > li{
	display: inline-block;
	margin-bottom: 5px;
}

.intro-heading span {
	color: #d91d1c;
	font-weight:bold;
}
.intro-heading {
	font-size: 24px !important;
	color: #527bdd;
}
.intro-lead-in {
	font-size: 16px !important;
	line-height: 20px !important;
}
.photo {
	max-width: 200px;
	height: 100%;
	background-position: center center;
	background-repeat: no-repeat;
	overflow: hidden;
}
.hero-feature h3 {
	font-size: 22px;
	margin-top: 10px;
}
.hero-feature h3 span { color: #d91d1c; font-weight: bold; }
.hero-feature p { font-size: 13px; }
.hero-feature img { height: 300px; }
.photo img {
	min-height: 100%;
	min-width: 100%;
	/* IE 8 */
	-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
	/* IE 5-7 */
	filter: alpha(opacity=0);
	/* modern browsers */
	opacity: 0;
}
.hero-feature .blue:hover { background-color:#d91d1c; border-color:red;}
.caption h3 { text-align:center; }
.caption { text-align:justify; }
@media (min-width:980px) {
	.modal-dialog {width:820px;}
	.intro-text {
		padding-top:15px !important;
		padding-bottom:0px !important;
	}
}
.btn.red:hover {
	border-color:#fec503;
	background-color:#fec503;
}
</style>
<!-- Header -->
            <div class="row" id="candidats">

    <header>
    <div id="header_overlay" class="white" style="border-bottom: 2px solid #527bdd;">
	    <div class="container">
		    <div class="row" style="padding-top:10px;">
		    <% ballot['candidates'].each do |candidate| %>
			    <div class="col-sm-12 col-xs-12 hero-feature">
				    <div class="thumbnail" style="margin-bottom:5px;">
					    <div class="row">
						    <div class="col-md-3 col-sm-12 hero-feature">
							    <div class="photo background"style="background-image: url('https://s3.eu-central-1.amazonaws.com/laprimaire/<%= candidate['photo'] %>');">
								    <img class="background" src="https://s3.eu-central-1.amazonaws.com/laprimaire/<%= candidate['photo'] %>" alt="<%= candidate['name'] %>">
								    <div id="video-button" data-toggle="modal" data-target="#Iwatch"></div>
							    </div>
						    </div>
						    <div class="col-md-9 col-sm-12 hero-feature">
							    <div class="row">
								    <div>
									    <div class="intro-text">
										    <div style="margin-bottom:-7px;" class="intro-heading"><%= candidate['firstname'] %> <span><%= candidate['lastname'] %></span></div>
										    <p class="about"><%= "#{candidate['age']} ans, #{candidate['job']} (#{candidate['departement']})" %></p>
										    <div class="intro-lead-in">&ldquo;<i><%= candidate['vision'] %></i>&rdquo;</div>
									    </div>
								    </div>
							    </div>
							    <div class="row">
								    <div style="margin-bottom:20px;">
									    <% if candidate['vote_casted'].to_b then %>
									    <button id="votebtn_<%= candidate['vote_id'] %>_done" data-toggle="modal" class="btn btn-success disabled" style="font-size:18px;width:180px;border-radius:4px;"><i class="fa fa-check" aria-hidden="true" style="padding:0px;"></i> Vote enregistré</button>
									    <% else %>
									    <button id="votebtn_<%= candidate['vote_id'] %>_done" data-toggle="modal" class="btn btn-success disabled" style="font-size:18px;width:180px;border-radius:4px;display:none;"><i class="fa fa-check" aria-hidden="true" style="padding:0px;"></i> Vote enregistré</button>
									    <button id="votebtn_<%= candidate['vote_id'] %>_todo" data-toggle="modal" data-target="#<%= candidate['vote_id'] %>_cc" class="btn red" style="font-size:18px;width:250px;border-radius:4px;">Evaluer <%= candidate['firstname'] %></button>
									    <% end %>
								    </div>
							    </div>
							    <div class="row">
								    <ul class="social_buttons">
									    <li><a href="test.com" target="_blank" class="btn btn-default btn-xs blue"><i class="fa fa-trello" aria-hidden="true"></i>Présentation</a></li>
									    <li><a href="test.com" target="_blank" class="btn btn-default btn-xs blue"><i class="fa fa-list-ol" aria-hidden="true"></i>Programme</a></li>
									    <li><a href="test.com" target="_blank" class="btn btn-default btn-xs blue"><i class="fa fa-microphone" aria-hidden="true"></i>Interview</a></li>
									    <li><a href="test.com" target="_blank" class="btn btn-default btn-xs blue"><i class="fa fa-video-camera" aria-hidden="true"></i>Direct</a></li>
									    <li><a href="test.com" target="_blank" class="btn btn-default btn-xs blue"><i class="fa fa-picture-o" aria-hidden="true"></i>Illustration</a></li>
									    <li><a href="test.com" target="_blank" class="btn btn-default btn-xs blue"><i class="fa fa-star" aria-hidden="true"></i>Priorités</a></li>
								    </ul>

							    </div>
						    </div>
					    </div>

				    </div>
			    </div>
		    <% end %>
		    </div>
	    </div>
    </div>
    </header>

    <% ballot['candidates'].each do |candidate| %>
    <div class="modal fade cocorico" id="<%= candidate['vote_id']%>_cc" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	    <div class="modal-dialog vote" role="document">
		    <div class="modal-content">
			    <div class="modal-body" >
				    <div style="margin:0 auto;background:#527bdd;height:100%;" id="<%= candidate['vote_id']%>_loading">
					    <div style="margin:0 auto;padding-top:100px;padding-bottom:100px;width:300px;color:white;text-align:center;">
						    <p>Chargement du vote en cours...</p>
						    <p><i style="width:100px;text-align:center;" class="fa fa-refresh fa-spin fa-3x fa-fw" aria-hidden="true"></i></p>
						    <span class="sr-only">Refreshing...</span>
						    <p>Vous disposez de 10 minutes pour évaluer <%= candidate['name']%>.</p>
					    </div>
				    </div>
				    <iframe name="prout" id="<%= candidate['vote_id']%>_iframe" width="100%" height="480px" style="display:none;" frameborder="0"></iframe>
			    </div>
		    </div>
	    </div>
    </div>
    <% end %>
    <script src="https://code.jquery.com/jquery-2.2.1.min.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script>
$(document).ready(function() {
		window.addEventListener("message",receiveMessage,true);
		function receiveMessage(e) { 
			if (e.origin!=='https://laprimaire.cocorico.cc') {
				return;
			}
			console.log(e);
			if (e['data']=='voteComplete') {
				$('.modal.cocorico').modal('hide');
				var voteId = e.target.window.document.location.pathname.split('/')[3];
				$('#votebtn_'+voteId+'_todo').hide();
				$('#votebtn_'+voteId+'_done').show();
			} else if (e['data']=='voteCanceled') {
				var voteId = e.source.window.document.location.pathname.split('/')[3];
				$('#votebtn_'+voteId+'_todo').hide();
				$('#votebtn_'+voteId+'_done').show();
				console.log('#votebtn_'+voteId+'_done');
				$('.modal.cocorico').modal('hide');
			}
		};
    <% ballot['candidates'].each do |candidate| %>
	    if ($('#<%= candidate['vote_id']%>_cc')!=null) {
	    $('#<%= candidate['vote_id']%>_cc').on('hidden.bs.modal', function () {
			    $('#<%= candidate['vote_id']%>_loading').show(); $('#<%= candidate['vote_id']%>_iframe').hide();
		    });

		    $('#<%= candidate['vote_id']%>_cc').on('shown.bs.modal', function () {
			    $('#<%= candidate['vote_id']%>_iframe').load(function() { $('#<%= candidate['vote_id']%>_loading').hide(); $('#<%= candidate['vote_id']%>_iframe').show();});
			    $.ajax({
				url: "/citoyen/token/<%= citoyen['user_key'] %>",
				data: "ballot=<%= ballot['ballot_id'] %>&candidate=<%= candidate['candidate_id'] %>",
				dataType: "json",
				success: function(data) {
				$('#<%= candidate['vote_id']%>_iframe').attr("src",'https://<%= COCORICO_HOST %>/embed/vote-widget/<%= candidate['vote_id'] %>?user='+data['token']+'&appId=<%= cocorico_app_id %>&lang=fr-FR');
				}
			    });
		});
	}
    <% end %>
});
    </script>
    <script src="https://use.fontawesome.com/1e37fa74cb.js"></script>
